n=2  #樣本數
k=3#管制界線
delta=3 #位移量
1/((1-pnorm(k-delta*sqrt(n),0,1))+(pnorm(-k-delta*sqrt(n))))
n=2  #樣本數
k=2  #管制界線
delta=3 #位移量
1/((1-pnorm(k-delta*sqrt(n),0,1))+(pnorm(-k-delta*sqrt(n))))
n=2  #樣本數
k=4  #管制界線
delta=3 #位移量
1/((1-pnorm(k-delta*sqrt(n),0,1))+(pnorm(-k-delta*sqrt(n))))
n=2  #樣本數
k=4  #管制界線
delta=4 #位移量
1/((1-pnorm(k-delta*sqrt(n),0,1))+(pnorm(-k-delta*sqrt(n))))
n=2  #樣本數
k=2  #管制界線
delta=4 #位移量
1/((1-pnorm(k-delta*sqrt(n),0,1))+(pnorm(-k-delta*sqrt(n))))
n=2  #樣本數
k=3  #管制界線
delta=4 #位移量
1/((1-pnorm(k-delta*sqrt(n),0,1))+(pnorm(-k-delta*sqrt(n))))
n=2  #樣本數
delta=4 #位移量
k=2
1/((1-pnorm(k-delta*sqrt(n),0,1))+(pnorm(-k-delta*sqrt(n))))
k=3
1/((1-pnorm(k-delta*sqrt(n),0,1))+(pnorm(-k-delta*sqrt(n))))
k=3.5
1/((1-pnorm(k-delta*sqrt(n),0,1))+(pnorm(-k-delta*sqrt(n))))
k=4
1/((1-pnorm(k-delta*sqrt(n),0,1))+(pnorm(-k-delta*sqrt(n))))
n=5  #樣本數
delta=0 #位移量
k=2
1/((1-pnorm(k-delta*sqrt(n),0,1))+(pnorm(-k-delta*sqrt(n))))
k=3
1/((1-pnorm(k-delta*sqrt(n),0,1))+(pnorm(-k-delta*sqrt(n))))
k=3.5
1/((1-pnorm(k-delta*sqrt(n),0,1))+(pnorm(-k-delta*sqrt(n))))
k=4
1/((1-pnorm(k-delta*sqrt(n),0,1))+(pnorm(-k-delta*sqrt(n))))
n=5  #樣本數
delta=0.25 #位移量
k=2
1/((1-pnorm(k-delta*sqrt(n),0,1))+(pnorm(-k-delta*sqrt(n))))
k=3
1/((1-pnorm(k-delta*sqrt(n),0,1))+(pnorm(-k-delta*sqrt(n))))
k=3.5
1/((1-pnorm(k-delta*sqrt(n),0,1))+(pnorm(-k-delta*sqrt(n))))
k=4
1/((1-pnorm(k-delta*sqrt(n),0,1))+(pnorm(-k-delta*sqrt(n))))
n=5  #樣本數
delta=0.5 #位移量
k=2
1/((1-pnorm(k-delta*sqrt(n),0,1))+(pnorm(-k-delta*sqrt(n))))
k=3
1/((1-pnorm(k-delta*sqrt(n),0,1))+(pnorm(-k-delta*sqrt(n))))
k=3.5
1/((1-pnorm(k-delta*sqrt(n),0,1))+(pnorm(-k-delta*sqrt(n))))
k=4
1/((1-pnorm(k-delta*sqrt(n),0,1))+(pnorm(-k-delta*sqrt(n))))
n=5  #樣本數
delta=0.75 #位移量
k=2
1/((1-pnorm(k-delta*sqrt(n),0,1))+(pnorm(-k-delta*sqrt(n))))
k=3
1/((1-pnorm(k-delta*sqrt(n),0,1))+(pnorm(-k-delta*sqrt(n))))
k=3.5
1/((1-pnorm(k-delta*sqrt(n),0,1))+(pnorm(-k-delta*sqrt(n))))
k=4
1/((1-pnorm(k-delta*sqrt(n),0,1))+(pnorm(-k-delta*sqrt(n))))
n=5  #樣本數
delta=1 #位移量
k=2
1/((1-pnorm(k-delta*sqrt(n),0,1))+(pnorm(-k-delta*sqrt(n))))
k=3
1/((1-pnorm(k-delta*sqrt(n),0,1))+(pnorm(-k-delta*sqrt(n))))
k=3.5
1/((1-pnorm(k-delta*sqrt(n),0,1))+(pnorm(-k-delta*sqrt(n))))
k=4
1/((1-pnorm(k-delta*sqrt(n),0,1))+(pnorm(-k-delta*sqrt(n))))
n=5  #樣本數
delta=1.5 #位移量
k=2
1/((1-pnorm(k-delta*sqrt(n),0,1))+(pnorm(-k-delta*sqrt(n))))
k=3
1/((1-pnorm(k-delta*sqrt(n),0,1))+(pnorm(-k-delta*sqrt(n))))
k=3.5
1/((1-pnorm(k-delta*sqrt(n),0,1))+(pnorm(-k-delta*sqrt(n))))
k=4
1/((1-pnorm(k-delta*sqrt(n),0,1))+(pnorm(-k-delta*sqrt(n))))
n=5  #樣本數
delta=2 #位移量
k=2
1/((1-pnorm(k-delta*sqrt(n),0,1))+(pnorm(-k-delta*sqrt(n))))
k=3
1/((1-pnorm(k-delta*sqrt(n),0,1))+(pnorm(-k-delta*sqrt(n))))
k=3.5
1/((1-pnorm(k-delta*sqrt(n),0,1))+(pnorm(-k-delta*sqrt(n))))
k=4
1/((1-pnorm(k-delta*sqrt(n),0,1))+(pnorm(-k-delta*sqrt(n))))
n=5  #樣本數
delta=2.5 #位移量
k=2
1/((1-pnorm(k-delta*sqrt(n),0,1))+(pnorm(-k-delta*sqrt(n))))
k=3
1/((1-pnorm(k-delta*sqrt(n),0,1))+(pnorm(-k-delta*sqrt(n))))
k=3.5
1/((1-pnorm(k-delta*sqrt(n),0,1))+(pnorm(-k-delta*sqrt(n))))
k=4
1/((1-pnorm(k-delta*sqrt(n),0,1))+(pnorm(-k-delta*sqrt(n))))
n=5  #樣本數
delta=3 #位移量
k=2
1/((1-pnorm(k-delta*sqrt(n),0,1))+(pnorm(-k-delta*sqrt(n))))
k=3
1/((1-pnorm(k-delta*sqrt(n),0,1))+(pnorm(-k-delta*sqrt(n))))
k=3.5
1/((1-pnorm(k-delta*sqrt(n),0,1))+(pnorm(-k-delta*sqrt(n))))
k=4
1/((1-pnorm(k-delta*sqrt(n),0,1))+(pnorm(-k-delta*sqrt(n))))
n=5  #樣本數
delta=4 #位移量
k=2
1/((1-pnorm(k-delta*sqrt(n),0,1))+(pnorm(-k-delta*sqrt(n))))
k=3
1/((1-pnorm(k-delta*sqrt(n),0,1))+(pnorm(-k-delta*sqrt(n))))
k=3.5
1/((1-pnorm(k-delta*sqrt(n),0,1))+(pnorm(-k-delta*sqrt(n))))
k=4
1/((1-pnorm(k-delta*sqrt(n),0,1))+(pnorm(-k-delta*sqrt(n))))
n=10  #樣本數
delta=0 #位移量
k=2
1/((1-pnorm(k-delta*sqrt(n),0,1))+(pnorm(-k-delta*sqrt(n))))
k=3
1/((1-pnorm(k-delta*sqrt(n),0,1))+(pnorm(-k-delta*sqrt(n))))
k=3.5
1/((1-pnorm(k-delta*sqrt(n),0,1))+(pnorm(-k-delta*sqrt(n))))
k=4
1/((1-pnorm(k-delta*sqrt(n),0,1))+(pnorm(-k-delta*sqrt(n))))
n=10  #樣本數
delta=0.25 #位移量
k=2
1/((1-pnorm(k-delta*sqrt(n),0,1))+(pnorm(-k-delta*sqrt(n))))
k=3
1/((1-pnorm(k-delta*sqrt(n),0,1))+(pnorm(-k-delta*sqrt(n))))
k=3.5
1/((1-pnorm(k-delta*sqrt(n),0,1))+(pnorm(-k-delta*sqrt(n))))
k=4
1/((1-pnorm(k-delta*sqrt(n),0,1))+(pnorm(-k-delta*sqrt(n))))
n=10  #樣本數
delta=0.5 #位移量
k=2
1/((1-pnorm(k-delta*sqrt(n),0,1))+(pnorm(-k-delta*sqrt(n))))
k=3
1/((1-pnorm(k-delta*sqrt(n),0,1))+(pnorm(-k-delta*sqrt(n))))
k=3.5
1/((1-pnorm(k-delta*sqrt(n),0,1))+(pnorm(-k-delta*sqrt(n))))
k=4
1/((1-pnorm(k-delta*sqrt(n),0,1))+(pnorm(-k-delta*sqrt(n))))
n=10  #樣本數
delta=0.75 #位移量
k=2
1/((1-pnorm(k-delta*sqrt(n),0,1))+(pnorm(-k-delta*sqrt(n))))
k=3
1/((1-pnorm(k-delta*sqrt(n),0,1))+(pnorm(-k-delta*sqrt(n))))
k=3.5
1/((1-pnorm(k-delta*sqrt(n),0,1))+(pnorm(-k-delta*sqrt(n))))
k=4
1/((1-pnorm(k-delta*sqrt(n),0,1))+(pnorm(-k-delta*sqrt(n))))
n=10  #樣本數
delta=1 #位移量
k=2
1/((1-pnorm(k-delta*sqrt(n),0,1))+(pnorm(-k-delta*sqrt(n))))
k=3
1/((1-pnorm(k-delta*sqrt(n),0,1))+(pnorm(-k-delta*sqrt(n))))
k=3.5
1/((1-pnorm(k-delta*sqrt(n),0,1))+(pnorm(-k-delta*sqrt(n))))
k=4
1/((1-pnorm(k-delta*sqrt(n),0,1))+(pnorm(-k-delta*sqrt(n))))
n=10  #樣本數
delta=1.5 #位移量
k=2
1/((1-pnorm(k-delta*sqrt(n),0,1))+(pnorm(-k-delta*sqrt(n))))
k=3
1/((1-pnorm(k-delta*sqrt(n),0,1))+(pnorm(-k-delta*sqrt(n))))
k=3.5
1/((1-pnorm(k-delta*sqrt(n),0,1))+(pnorm(-k-delta*sqrt(n))))
k=4
1/((1-pnorm(k-delta*sqrt(n),0,1))+(pnorm(-k-delta*sqrt(n))))
n=10  #樣本數
delta=2 #位移量
k=2
1/((1-pnorm(k-delta*sqrt(n),0,1))+(pnorm(-k-delta*sqrt(n))))
k=3
1/((1-pnorm(k-delta*sqrt(n),0,1))+(pnorm(-k-delta*sqrt(n))))
k=3.5
1/((1-pnorm(k-delta*sqrt(n),0,1))+(pnorm(-k-delta*sqrt(n))))
k=4
1/((1-pnorm(k-delta*sqrt(n),0,1))+(pnorm(-k-delta*sqrt(n))))
n=10  #樣本數
delta=2.5 #位移量
k=2
1/((1-pnorm(k-delta*sqrt(n),0,1))+(pnorm(-k-delta*sqrt(n))))
k=3
1/((1-pnorm(k-delta*sqrt(n),0,1))+(pnorm(-k-delta*sqrt(n))))
k=3.5
1/((1-pnorm(k-delta*sqrt(n),0,1))+(pnorm(-k-delta*sqrt(n))))
k=4
1/((1-pnorm(k-delta*sqrt(n),0,1))+(pnorm(-k-delta*sqrt(n))))
n=10  #樣本數
delta=3 #位移量
k=2
1/((1-pnorm(k-delta*sqrt(n),0,1))+(pnorm(-k-delta*sqrt(n))))
k=3
1/((1-pnorm(k-delta*sqrt(n),0,1))+(pnorm(-k-delta*sqrt(n))))
k=3.5
1/((1-pnorm(k-delta*sqrt(n),0,1))+(pnorm(-k-delta*sqrt(n))))
k=4
1/((1-pnorm(k-delta*sqrt(n),0,1))+(pnorm(-k-delta*sqrt(n))))
library(ggplot2)
eqPalette = c("#892e82",
"#0f0fbc",
"#298b0d",
"#fad304",
"#ff6600",
"#e31c3f")
eq <- data.frame(x = 0, v = eqPalette)
install.packages("ggplot2")
library(ggplot2)
eqPalette = c("#892e82",
"#0f0fbc",
"#298b0d",
"#fad304",
"#ff6600",
"#e31c3f")
eq <- data.frame(x = 0, v = eqPalette)
library(ggplot2)
eqPalette = c("#892e82",
"#0f0fbc",
"#298b0d",
"#fad304",
"#ff6600",
"#e31c3f")
eq <- data.frame(x = 0, v = eqPalette)
ggplot(eq, aes(x = x, fill = v)) +
geom_bar(position="fill") +
scale_fill_manual(values = alpha(eqPalette, .8)) +
theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
axis.title.y=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank(),
panel.background=element_blank(),
legend.position="none")
library(ggplot2)
eqPalette = c("#892e82",
"#0f0fbc",
"#298b0d",
"#fad304",
"#ff6600",
"#e31c3f")
eq <- data.frame(x = 0, v = eqPalette)
ggplot(eq, aes(x = x, fill = v)) +
geom_bar(position="fill") +
scale_fill_manual(values = alpha(eqPalette, .8)) +
theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
axis.title.y=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank(),
panel.background=element_blank(),
legend.position="none")
ggplot(eq, aes(x = x, fill = v)) +
geom_bar(position="fill") +
scale_fill_manual(values = alpha(eqPalette, .9)) +
theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
axis.title.y=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank(),
panel.background=element_blank(),
legend.position="none")
ggplot(eq, aes(x = x, fill = v)) +
geom_bar(position="fill") +
scale_fill_manual(values = alpha(eqPalette, 20)) +
theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
axis.title.y=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank(),
panel.background=element_blank(),
legend.position="none")
ggplot(eq, aes(x = x, fill = v)) +
geom_bar(position="fill") +
scale_fill_manual(values = alpha(eqPalette, .1)) +
theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
axis.title.y=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank(),
panel.background=element_blank(),
legend.position="none")
ggplot(eq, aes(x = x, fill = v)) +
geom_bar(position="fill") +
scale_fill_manual(values = alpha(eqPalette, .5)) +
theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
axis.title.y=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank(),
panel.background=element_blank(),
legend.position="none")
library(ggplot2)
eqPalette = c("#892e82",
"#0f0fbc",
"#298b0d",
"#fad304",
"#ff6600",
"#e31c3f")
eq <- data.frame(x = 0, v = eqPalette)
ggplot(eq, aes(x = x, fill = v)) +
geom_bar(position="fill") +
scale_fill_manual(values = alpha(eqPalette, .5)) +
theme(
legend.position="none")
?legend.position
?theme
library(ggplot2)
eqPalette = c("#892e82",
"#0f0fbc",
"#298b0d",
"#fad304",
"#ff6600",
"#e31c3f")
eq <- data.frame(x = 0, v = eqPalette)
ggplot(eq, aes(x = x, fill = v)) +
geom_bar(position="fill") +
scale_fill_manual(values = alpha(eqPalette, .5)) +
theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
axis.title.y=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank(),
panel.background=element_blank(),
legend.position="none")
library(ggplot2)
eqPalette = c("#892e82",
"#0f0fbc",
"#298b0d",
"#fad304",
"#ff6600",
"#e31c3f")
eq <- data.frame(x = 0, v = eqPalette)
ggplot(eq, aes(x = x, fill = v)) +
geom_bar(position="fill") +
scale_fill_manual(values = alpha(eqPalette, .5)) +
theme(
panel.background=element_blank(),
legend.position="none")
library(ggplot2)
eqPalette = c("#892e82",
"#0f0fbc",
"#298b0d",
"#fad304",
"#ff6600",
"#e31c3f")
eq <- data.frame(x = 0, v = eqPalette)
ggplot(eq, aes(x = x, fill = v)) +
geom_bar(position="fill") +
scale_fill_manual(values = alpha(eqPalette, .5)) +
theme(
legend.position="none")
library(ggplot2)
eqPalette = c("#892e82",
"#0f0fbc",
"#298b0d",
"#fad304",
"#ff6600",
"#e31c3f")
eq <- data.frame(x = 0, v = eqPalette)
ggplot(eq, aes(x = x, fill = v)) +
geom_bar(position="fill") +
scale_fill_manual(values = alpha(eqPalette, .5)) +
theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
axis.title.y=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank(),
panel.background=element_blank(),
legend.position="none")
help(rnorm)
library("qcc")
install.packages("qcc")
library(qcc)
RN <- rnorm(30, 10, 1)
RN
qcc(RN,type = "xbar",data.name = "Shewhart Chart")
qcc(RN,type = "xbar.one",data.name = "Shewhart Chart")
qcc(RN,type = "xbar.one",data.name = "Shewhart Chart")
view(RN)
sd(RN)
qcc(RN,type = "xbar.one",data.name = "Shewhart Chart")
RN1 <- rnorm(10, 10, 1)
RN2 <- rnorm(10, 11, 1)
RN3 <- rnorm(10, 12, 1)
help("qcc")
#League Batting Average (1973-2008)
require(ggplot2)
require(ggthemes)
require(xlsx)
require(qcc)
MLB_data <- read.xlsx("C:/Users/Kevin/Desktop/MLB_data.xlsx",1,header=T)
x<-MLB_data$Year
y<-MLB_data$Batting.Average
UCL <- 0.26774
CL <- 0.25865
LCL <- 0.24956
Control_Chart_Data <- data.frame(x,y,UCL,CL,LCL)
ggplot(data = Control_Chart_Data,aes(x = x,y = y))+
scale_x_continuous(breaks=seq(1969, 2008, 4), limits = c(1969, 2008))+
scale_y_continuous(breaks=seq(0.240, 0.275, 0.005), limits = c(0.240, 0.275))+
labs(x = "Year",y = "Batting Average")+
geom_point()+geom_line()+
geom_line(aes(y = LCL),color = "red")+
geom_line(aes(y = CL),color = "green")+
geom_line(aes(y = UCL),color = "red")+
theme_classic()+
theme(axis.line.x = element_line(color = "black"),
axis.line.y = element_line(color = "black"))
ewma(MLB_data$Batting.Average,lambda = 0.8,data.name = "BattingAverage")
cusum(MLB_data$Batting.Average ,data.name = "BattingAverage")
setwd("E:\\homework\\資料分析於健康醫療")
MLB_data <- read.xlsx("MLB_data.xlsx",1,header=T)
require(ggplot2)
require(ggthemes)
require(xlsx)
require(qcc)
setwd("E:\\homework\\資料分析於健康醫療")
MLB_data <- read.xlsx("MLB_data.xlsx",1,header=T)
RN4 <- merge(RN1,RN2,RN3)
RN4 <- merge(RN1,RN2)
RN4
RN1
rbind(RN1,RN2)
c(RN1,RN2,RN3)
UCL <-  12.73372
CL <- 9.920845
LCL <- 7.107967
ggplot(data = RN4,aes(x = x,y = y))+
geom_point()+geom_line()+
geom_line(aes(y = LCL),color = "red")+
geom_line(aes(y = CL),color = "green")+
geom_line(aes(y = UCL),color = "red")+
theme_classic()+
theme(axis.line.x = element_line(color = "black"),
axis.line.y = element_line(color = "black"))
Control_Chart_Data <- data.frame(x,y,UCL,CL,LCL)
x <-c(1:30)
y <- RN4
Control_Chart_Data <- data.frame(x,y,UCL,CL,LCL)
RN4 <- c(RN1,RN2,RN3)
x <-c(1:30)
y <- RN4
UCL <-  12.73372
CL <- 9.920845
LCL <- 7.107967
Control_Chart_Data <- data.frame(x,y,UCL,CL,LCL)
ggplot(data = Control_Chart_Data,aes(x = x,y = y))+
geom_point()+geom_line()+
geom_line(aes(y = LCL),color = "red")+
geom_line(aes(y = CL),color = "green")+
geom_line(aes(y = UCL),color = "red")+
theme_classic()+
theme(axis.line.x = element_line(color = "black"),
axis.line.y = element_line(color = "black"))
Control_Chart_Data <- data.frame(x,y,UCL,CL,LCL)
ggplot(data = Control_Chart_Data,aes(x = x,y = y))+
geom_point()+geom_line()+
geom_line(aes(y = LCL),color = "red")+
geom_line(aes(y = CL),color = "green")+
geom_line(aes(y = UCL),color = "red"))
ggplot(data = Control_Chart_Data,aes(x = x,y = y))+
geom_point()+geom_line()+
geom_line(aes(y = LCL),color = "red")+
geom_line(aes(y = CL),color = "green")+
geom_line(aes(y = UCL),color = "red")+
theme_classic())
ggplot(data = Control_Chart_Data,aes(x = x,y = y))+
geom_point()+geom_line()+
geom_line(aes(y = LCL),color = "red")+
geom_line(aes(y = CL),color = "green")+
geom_line(aes(y = UCL),color = "red")+
theme_classic()
ggplot(data = Control_Chart_Data,aes(x = x,y = y))+
geom_point()+geom_line()+
geom_line(aes(y = LCL),color = "red")+
geom_line(aes(y = CL),color = "green")+
geom_line(aes(y = UCL),color = "red")
y
